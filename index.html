<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>InternFund - Fundraising Platform</title>
    <style>
      :root {
        --primary-color: rgb(237, 7, 7);
        --primary-dark: rgb(180, 5, 5);
        --secondary-color: #000000;
        --background: #ffffff;
        --surface: #f8f8f8;
        --text-primary: #000000;
        --text-secondary: #444444;
        --border: #cccccc;
        --shadow: 0 8px 16px -2px rgba(0, 0, 0, 0.15);
        --shadow-lg: 0 20px 30px -6px rgba(0, 0, 0, 0.2);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--background);
        color: var(--text-primary);
        line-height: 1.4;
        font-size: 14px;
        min-height: 50vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .header {
        background: var(--surface);
        box-shadow: var(--shadow);
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 2px solid var(--primary-color);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
      }

      .logo {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary-color);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .nav-buttons button {
        background: white;
        border: 2px solid var(--secondary-color);
        padding: 8px 16px;
        margin-left: 8px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .nav-buttons button:hover {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
        transform: translateY(-2px);
      }

      .page {
        display: none;
        min-height: calc(100vh - 80px);
        padding: 20px 0;
      }

      .page.active {
        display: block;
      }

      .auth-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 70vh;
      }

      .auth-card {
        background: var(--surface);
        padding: 30px;
        border-radius: 15px;
        box-shadow: var(--shadow-lg);
        width: 100%;
        max-width: 450px;
        border: 2px solid var(--secondary-color);
      }

      .auth-card h2 {
        text-align: center;
        margin-bottom: 25px;
        color: var(--primary-color);
        font-size: 22px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      .form-group label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s;
        background: white;
      }

      .form-group input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(237, 7, 7, 0.1);
      }

      .btn {
        width: 100%;
        padding: 12px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        margin-bottom: 15px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .btn-small {
        width: auto;
        padding: 8px 16px;
        font-size: 12px;
        margin: 0;
      }

      .auth-switch {
        text-align: center;
        color: var(--text-secondary);
        font-size: 13px;
      }

      .auth-switch a {
        color: var(--primary-color);
        text-decoration: none;
        cursor: pointer;
        font-weight: bold;
      }

      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .card {
        background: var(--surface);
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        border: 2px solid var(--border);
        transition: all 0.3s;
      }

      .card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      .card h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        font-size: 16px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .stat-card {
        text-align: center;
        padding: 25px;
      }

      .stat-number {
        font-size: 36px;
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 8px;
      }

      .stat-label {
        color: var(--text-secondary);
        margin-top: 8px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .referral-code {
        background: var(--background);
        padding: 12px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 14px;
        text-align: center;
        border: 2px dashed var(--primary-color);
      }

      .reward-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px;
        border: 1px solid var(--border);
        border-radius: 6px;
        margin-bottom: 4px;
        font-size: 12px;
      }

      .reward-locked {
        opacity: 0.6;
      }

      .reward-unlocked {
        background: #f0fdf4;
        border-color: var(--secondary-color);
      }

      .donation-table-section {
        margin-top: 20px;
      }

      .donation-table-section h2 {
        font-size: 18px;
        margin-bottom: 15px;
        color: var(--primary-color);
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .donation-form {
        background: var(--surface);
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
        border: 2px solid var(--border);
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr 1fr auto;
        gap: 10px;
        align-items: end;
        margin-bottom: 10px;
      }

      .form-row input,
      .form-row textarea {
        padding: 8px;
        border: 2px solid var(--border);
        border-radius: 6px;
        font-size: 12px;
      }

      .form-row textarea {
        resize: vertical;
        min-height: 60px;
      }

      .form-row input[type="file"] {
        padding: 6px;
        font-size: 11px;
      }

      .donation-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        font-size: 12px;
        background: var(--surface);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: var(--shadow);
      }

      .donation-table th,
      .donation-table td {
        padding: 10px 12px;
        border: 1px solid var(--border);
        text-align: left;
      }

      .donation-table th {
        background-color: var(--primary-color);
        color: white;
        font-weight: 600;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .donation-table tbody tr:hover {
        background-color: #f9f9f9;
      }

      .donation-table img {
        max-height: 40px;
        max-width: 50px;
        border-radius: 4px;
        object-fit: cover;
      }

      .total-row {
        background: var(--primary-color) !important;
        color: white;
        font-weight: bold;
        font-size: 13px;
      }

      .edit-btn,
      .delete-btn {
        padding: 4px 8px;
        margin: 0 2px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 11px;
        transition: all 0.3s;
      }

      .edit-btn {
        background: #007bff;
        color: white;
      }

      .edit-btn:hover {
        background: #0056b3;
      }

      .delete-btn {
        background: #dc3545;
        color: white;
      }

      .delete-btn:hover {
        background: #c82333;
      }

      .leaderboard-table {
        background: var(--surface);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: var(--shadow);
      }

      .leaderboard-table table {
        width: 100%;
        border-collapse: collapse;
      }

      .leaderboard-table th,
      .leaderboard-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--border);
        font-size: 13px;
      }

      .leaderboard-table th {
        background: var(--primary-color);
        color: white;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .leaderboard-table tr:hover {
        background: var(--background);
      }

      .rank-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        font-weight: bold;
        color: white;
        font-size: 12px;
      }

      .rank-1 {
        background: #fbbf24;
      }
      .rank-2 {
        background: #9ca3af;
      }
      .rank-3 {
        background: #cd7c2f;
      }
      .rank-other {
        background: var(--primary-color);
      }

      .loading {
        text-align: center;
        padding: 20px;
      }

      .spinner {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid var(--border);
        border-top: 3px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 768px) {
        .dashboard-grid {
          grid-template-columns: 1fr;
        }

        .header-content {
          flex-direction: column;
          gap: 10px;
        }

        .nav-buttons {
          display: flex;
          gap: 5px;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .donation-table {
          font-size: 11px;
        }

        .donation-table th,
        .donation-table td {
          padding: 8px;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="logo">InternFund</div>
          <div class="nav-buttons">
            <button
              onclick="showPage('dashboard')"
              id="dashboardBtn"
              style="display: none"
            >
              Dashboard
            </button>
            <button
              onclick="showPage('leaderboard')"
              id="leaderboardBtn"
              style="display: none"
            >
              Leaderboard
            </button>
            <button onclick="logout()" id="logoutBtn" style="display: none">
              Logout
            </button>
          </div>
        </div>
      </div>
    </header>

    <div id="loginPage" class="page active">
      <div class="container">
        <div class="auth-container">
          <div class="auth-card">
            <h2>Login to InternFund</h2>
            <form id="loginForm">
              <div class="form-group">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" required />
              </div>
              <div class="form-group">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" required />
              </div>
              <button type="submit" class="btn">Login</button>
            </form>
            <div class="auth-switch">
              Don't have an account?
              <a onclick="showPage('signup')">Sign up here</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="signupPage" class="page">
      <div class="container">
        <div class="auth-container">
          <div class="auth-card">
            <h2>Join InternFund</h2>
            <form id="signupForm">
              <div class="form-group">
                <label for="signupName">Full Name</label>
                <input type="text" id="signupName" required />
              </div>
              <div class="form-group">
                <label for="signupEmail">Email</label>
                <input type="email" id="signupEmail" required />
              </div>
              <div class="form-group">
                <label for="signupPassword">Password</label>
                <input type="password" id="signupPassword" required />
              </div>
              <button type="submit" class="btn">Sign Up</button>
            </form>
            <div class="auth-switch">
              Already have an account?
              <a onclick="showPage('login')">Login here</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="dashboardPage" class="page">
      <div class="container">
        <h1 id="welcomeText">Welcome back!</h1>

        <div class="dashboard-grid">
          <div class="card">
            <h3>Your Profile</h3>
            <p><strong>Name:</strong> <span id="userName">Loading...</span></p>
            <p>
              <strong>Email:</strong> <span id="userEmail">Loading...</span>
            </p>
          </div>

          <div class="card">
            <h3>Your Referral Code</h3>
            <div class="referral-code" id="referralCode">Loading...</div>
            <p
              style="
                margin-top: 8px;
                color: var(--text-secondary);
                text-align: center;
              "
            >
              Share this code to earn rewards!
            </p>
          </div>

          <div class="card stat-card">
            <div class="stat-number" id="totalRaised">$0</div>
            <div class="stat-label">Total Donations Raised</div>
          </div>

          <div class="card">
            <h3>Rewards & Unlockables</h3>
            <div id="rewardsList">
              <div class="reward-item reward-unlocked">
                <span>Welcome Badge</span>
                <span style="color: var(--secondary-color)">✓ Unlocked</span>
              </div>
              <div class="reward-item reward-locked">
                <span>$500 Milestone Badge</span>
                <span>🔒 Locked</span>
              </div>
              <div class="reward-item reward-locked">
                <span>Top 10 Fundraiser</span>
                <span>🔒 Locked</span>
              </div>
              <div class="reward-item reward-locked">
                <span>$1000 Champion</span>
                <span>🔒 Locked</span>
              </div>
            </div>
          </div>
        </div>

        <div class="donation-table-section">
          <h2>Donation Management</h2>
          <div class="donation-form">
            <div class="form-row">
              <div>
                <label>Amount ($)</label>
                <input
                  type="number"
                  id="donationAmount"
                  placeholder="Enter amount"
                  min="0"
                  step="0.01"
                />
              </div>
              <div>
                <label>Details</label>
                <textarea
                  id="donationDetails"
                  placeholder="How did you raise these funds?"
                ></textarea>
              </div>
              <div>
                <label>Date</label>
                <input type="date" id="donationDate" />
              </div>
              <div>
                <label>Proof Image</label>
                <input type="file" id="donationImage" accept="image/*" />
              </div>
              <div>
                <label>&nbsp;</label>
                <button
                  type="button"
                  class="btn btn-small"
                  onclick="addDonation()"
                >
                  Add Entry
                </button>
              </div>
            </div>
          </div>

          <table class="donation-table" id="donationTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Amount</th>
                <th>Details</th>
                <th>Proof</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="donationTableBody"></tbody>
            <tfoot>
              <tr class="total-row">
                <td><strong>TOTAL</strong></td>
                <td><strong id="donationTotal">$0.00</strong></td>
                <td colspan="3"></td>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>

    <div id="leaderboardPage" class="page">
      <div class="container">
        <h1>Fundraising Leaderboard</h1>

        <div class="leaderboard-table">
          <table>
            <thead>
              <tr>
                <th>Rank</th>
                <th>Name</th>
                <th>Amount Raised</th>
                <th>Referral Code</th>
              </tr>
            </thead>
            <tbody id="leaderboardBody">
              <tr>
                <td colspan="4" class="loading">
                  <div class="spinner"></div>
                  <p>Loading leaderboard...</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.0/firebase-firestore-compat.min.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyDM0136Z0CpQd0984sCPSISjCeHJgt4-yo",
        authDomain: "internfund.firebaseapp.com",
        projectId: "internfund",
        storageBucket: "internfund.firebasestorage.app",
        messagingSenderId: "649902893025",
        appId: "1:649902893025:web:35273cae44258bc1c054a0",
        measurementId: "G-CM8714HR50",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      let currentUser = null;
      let editingDonationIndex = -1;

      function showPage(pageName) {
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });

        document.getElementById(pageName + "Page").classList.add("active");

        if (pageName === "login" || pageName === "signup") {
          document.getElementById("dashboardBtn").style.display = "none";
          document.getElementById("leaderboardBtn").style.display = "none";
          document.getElementById("logoutBtn").style.display = "none";
        } else {
          document.getElementById("dashboardBtn").style.display =
            "inline-block";
          document.getElementById("leaderboardBtn").style.display =
            "inline-block";
          document.getElementById("logoutBtn").style.display = "inline-block";
        }

        if (pageName === "leaderboard") {
          loadLeaderboard();
        }
      }

      function generateReferralCode(username) {
        const randomNum = Math.floor(Math.random() * 9000) + 1000;
        return username.toLowerCase().replace(/\s+/g, "") + randomNum;
      }

      document
        .getElementById("loginForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const email = document.getElementById("loginEmail").value;
          const password = document.getElementById("loginPassword").value;

          try {
            const users = JSON.parse(localStorage.getItem("users") || "[]");
            const user = users.find(
              (u) => u.email === email && u.password === password
            );

            if (user) {
              currentUser = user;
              localStorage.setItem("currentUser", JSON.stringify(user));
              loadDashboard();
              showPage("dashboard");
            } else {
              alert("Invalid credentials. Please try signing up first.");
            }
          } catch (error) {
            alert("Login failed: " + error.message);
          }
        });

      document
        .getElementById("signupForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const name = document.getElementById("signupName").value;
          const email = document.getElementById("signupEmail").value;
          const password = document.getElementById("signupPassword").value;

          try {
            const users = JSON.parse(localStorage.getItem("users") || "[]");
            if (users.find((u) => u.email === email)) {
              alert("User already exists. Please login instead.");
              return;
            }

            const newUser = {
              id: Date.now().toString(),
              name: name,
              email: email,
              password: password,
              referralCode: generateReferralCode(name),
              totalRaised: 0,
              donations: [],
              createdAt: new Date().toISOString(),
            };

            users.push(newUser);
            localStorage.setItem("users", JSON.stringify(users));

            currentUser = newUser;
            localStorage.setItem("currentUser", JSON.stringify(newUser));

            loadDashboard();
            showPage("dashboard");

            alert("Account created successfully!");
          } catch (error) {
            alert("Signup failed: " + error.message);
          }
        });

      function loadDashboard() {
        if (!currentUser) return;

        document.getElementById(
          "welcomeText"
        ).textContent = `Welcome back, ${currentUser.name}!`;
        document.getElementById("userName").textContent = currentUser.name;
        document.getElementById("userEmail").textContent = currentUser.email;
        document.getElementById("referralCode").textContent =
          currentUser.referralCode;

        updateTotalRaised();
        loadDonationTable();
        updateRewards();
      }

      function updateTotalRaised() {
        if (!currentUser.donations) currentUser.donations = [];
        const total = currentUser.donations.reduce(
          (sum, donation) => sum + parseFloat(donation.amount || 0),
          0
        );
        currentUser.totalRaised = total;

        document.getElementById(
          "totalRaised"
        ).textContent = `$${total.toLocaleString()}`;
        document.getElementById(
          "donationTotal"
        ).textContent = `$${total.toFixed(2)}`;

        const users = JSON.parse(localStorage.getItem("users") || "[]");
        const userIndex = users.findIndex((u) => u.id === currentUser.id);
        if (userIndex !== -1) {
          users[userIndex] = currentUser;
          localStorage.setItem("users", JSON.stringify(users));
          localStorage.setItem("currentUser", JSON.stringify(currentUser));
        }
      }

      function addDonation() {
        const amount = document.getElementById("donationAmount").value;
        const details = document.getElementById("donationDetails").value;
        const date = document.getElementById("donationDate").value;
        const imageFile = document.getElementById("donationImage").files[0];

        if (!amount || !details || !date) {
          alert("Please fill in all required fields (Amount, Details, Date)");
          return;
        }

        const donation = {
          id: Date.now().toString(),
          amount: parseFloat(amount),
          details: details,
          date: date,
          image: null,
        };

        if (imageFile) {
          const reader = new FileReader();
          reader.onload = function (e) {
            donation.image = e.target.result;
            saveDonation(donation);
          };
          reader.readAsDataURL(imageFile);
        } else {
          saveDonation(donation);
        }
      }

      function saveDonation(donation) {
        if (!currentUser.donations) currentUser.donations = [];

        if (editingDonationIndex >= 0) {
          currentUser.donations[editingDonationIndex] = donation;
          editingDonationIndex = -1;
        } else {
          currentUser.donations.push(donation);
        }

        clearDonationForm();
        loadDonationTable();
        updateTotalRaised();
        updateRewards();
      }

      function clearDonationForm() {
        document.getElementById("donationAmount").value = "";
        document.getElementById("donationDetails").value = "";
        document.getElementById("donationDate").value = "";
        document.getElementById("donationImage").value = "";
      }

      function loadDonationTable() {
        const tbody = document.getElementById("donationTableBody");
        tbody.innerHTML = "";

        if (!currentUser.donations || currentUser.donations.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="5" style="text-align: center; padding: 20px; color: var(--text-secondary);">
                No donations recorded yet. Add your first donation above!
              </td>
            </tr>
          `;
          return;
        }

        currentUser.donations.forEach((donation, index) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${new Date(donation.date).toLocaleDateString()}</td>
            <td>$${parseFloat(donation.amount).toFixed(2)}</td>
            <td>${donation.details}</td>
            <td>${
              donation.image
                ? `<img src="${donation.image}" alt="Proof">`
                : "No image"
            }</td>
            <td>
              <button class="edit-btn" onclick="editDonation(${index})">Edit</button>
              <button class="delete-btn" onclick="deleteDonation(${index})">Delete</button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function editDonation(index) {
        const donation = currentUser.donations[index];
        document.getElementById("donationAmount").value = donation.amount;
        document.getElementById("donationDetails").value = donation.details;
        document.getElementById("donationDate").value = donation.date;
        editingDonationIndex = index;
      }

      function deleteDonation(index) {
        if (confirm("Are you sure you want to delete this donation entry?")) {
          currentUser.donations.splice(index, 1);
          loadDonationTable();
          updateTotalRaised();
          updateRewards();
        }
      }

      function updateRewards() {
        const amount = currentUser.totalRaised;
        const rewards = document.querySelectorAll(".reward-item");

        if (amount >= 500) {
          rewards[1].classList.remove("reward-locked");
          rewards[1].classList.add("reward-unlocked");
          rewards[1].querySelector("span:last-child").innerHTML =
            '<span style="color: var(--secondary-color);">✓ Unlocked</span>';
        }

        if (amount >= 1000) {
          rewards[3].classList.remove("reward-locked");
          rewards[3].classList.add("reward-unlocked");
          rewards[3].querySelector("span:last-child").innerHTML =
            '<span style="color: var(--secondary-color);">✓ Unlocked</span>';
        }
      }

      function loadLeaderboard() {
        const users = JSON.parse(localStorage.getItem("users") || "[]");
        const leaderboardBody = document.getElementById("leaderboardBody");

        if (users.length === 0) {
          leaderboardBody.innerHTML = `
            <tr>
              <td colspan="4" style="text-align: center; padding: 20px;">
                No users found. Be the first to sign up!
              </td>
            </tr>
          `;
          return;
        }

        users.sort((a, b) => b.totalRaised - a.totalRaised);

        const currentUserIndex = users.findIndex(
          (u) => u.id === currentUser?.id
        );
        if (currentUserIndex !== -1 && currentUserIndex < 10) {
          const rewards = document.querySelectorAll(".reward-item");
          rewards[2].classList.remove("reward-locked");
          rewards[2].classList.add("reward-unlocked");
          rewards[2].querySelector("span:last-child").innerHTML =
            '<span style="color: var(--secondary-color);">✓ Unlocked</span>';
        }

        leaderboardBody.innerHTML = users
          .map((user, index) => {
            const rankClass =
              index === 0
                ? "rank-1"
                : index === 1
                ? "rank-2"
                : index === 2
                ? "rank-3"
                : "rank-other";
            return `
              <tr ${
                user.id === currentUser?.id
                  ? 'style="background: #fef3c7;"'
                  : ""
              }>
                <td>
                  <span class="rank-badge ${rankClass}">${index + 1}</span>
                </td>
                <td>
                  ${user.name}
                  ${user.id === currentUser?.id ? "<strong>(You)</strong>" : ""}
                </td>
                <td>${user.totalRaised.toLocaleString()}</td>
                <td style="font-family: monospace;">${user.referralCode}</td>
              </tr>
            `;
          })
          .join("");
      }

      function logout() {
        currentUser = null;
        localStorage.removeItem("currentUser");
        showPage("login");

        document.getElementById("loginForm").reset();
        document.getElementById("signupForm").reset();
      }

      document.addEventListener("DOMContentLoaded", () => {
        const savedUser = localStorage.getItem("currentUser");
        if (savedUser) {
          currentUser = JSON.parse(savedUser);
          loadDashboard();
          showPage("dashboard");
        }
      });

      function seedDemoData() {
        const existingUsers = JSON.parse(localStorage.getItem("users") || "[]");
        if (existingUsers.length === 0) {
          const demoUsers = [
            {
              id: "1",
              name: "Alice Johnson",
              email: "alice@demo.com",
              password: "demo123",
              referralCode: "alice3847",
              totalRaised: 1250,
              donations: [
                {
                  id: "d1",
                  amount: 750,
                  details:
                    "Organized charity bake sale at local community center",
                  date: "2024-07-15",
                  image: null,
                },
                {
                  id: "d2",
                  amount: 500,
                  details: "Online crowdfunding campaign for education support",
                  date: "2024-07-22",
                  image: null,
                },
              ],
              createdAt: new Date().toISOString(),
            },
            {
              id: "2",
              name: "Bob Smith",
              email: "bob@demo.com",
              password: "demo123",
              referralCode: "bob9283",
              totalRaised: 950,
              donations: [
                {
                  id: "d3",
                  amount: 950,
                  details: "Car wash fundraiser in neighborhood",
                  date: "2024-07-10",
                  image: null,
                },
              ],
              createdAt: new Date().toISOString(),
            },
            {
              id: "3",
              name: "Carol Davis",
              email: "carol@demo.com",
              password: "demo123",
              referralCode: "carol5746",
              totalRaised: 1800,
              donations: [
                {
                  id: "d4",
                  amount: 1200,
                  details: "Corporate sponsorship from local business",
                  date: "2024-07-05",
                  image: null,
                },
                {
                  id: "d5",
                  amount: 600,
                  details: "Silent auction at school event",
                  date: "2024-07-18",
                  image: null,
                },
              ],
              createdAt: new Date().toISOString(),
            },
            {
              id: "4",
              name: "David Wilson",
              email: "david@demo.com",
              password: "demo123",
              referralCode: "david2947",
              totalRaised: 750,
              donations: [
                {
                  id: "d6",
                  amount: 750,
                  details: "Social media fundraising campaign",
                  date: "2024-07-12",
                  image: null,
                },
              ],
              createdAt: new Date().toISOString(),
            },
            {
              id: "5",
              name: "Emma Brown",
              email: "emma@demo.com",
              password: "demo123",
              referralCode: "emma8372",
              totalRaised: 1100,
              donations: [
                {
                  id: "d7",
                  amount: 650,
                  details: "Garage sale proceeds donated to cause",
                  date: "2024-07-08",
                  image: null,
                },
                {
                  id: "d8",
                  amount: 450,
                  details: "Birthday party donations instead of gifts",
                  date: "2024-07-20",
                  image: null,
                },
              ],
              createdAt: new Date().toISOString(),
            },
          ];
          localStorage.setItem("users", JSON.stringify(demoUsers));
        }
      }

      seedDemoData();
    </script>
  </body>
</html>
